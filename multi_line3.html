<!DOCTYPE html>
<meta charset="utf-8">
<head>
        <title>
            First Multi-series line Graph   
        </title>
        
        <script src="http://d3js.org/d3.v3.js"></script>
        <script src="https://code.jquery.com/jquery-2.1.1.js"></script>            
        <script type="text/javascript"></script>
        <style type = "text/css">
                body { font: 12px Arial;}

                path { 
                    stroke: black;
                    stroke-width: 1;
                    fill: none;
                }
                
                .axis path,
                .axis line {
                    fill: none;
                    stroke: grey;
                    stroke-width: 2;
                    shape-rendering: crispEdges;
                }
        </style>
</head>

<body>
    <script>
        //Margins
        var margin = {top: 20, right: 80, bottom: 30, left: 50},
                width = 900 - margin.left - margin.right,
                height = 500 - margin.top - margin.bottom;
        
        //Scales
        var x_scale = d3.time.scale()
                .range([0, width]);
        
        var y_scale = d3.scale.linear()
                .range([height, 0]);
                
        var color = d3.scale.category10();
                
        //Axis for the graph
        var x_axis = d3.svg.axis()
                .scale(x_scale)
                .orient("bottom")
                .ticks(5);
                        
        var y_axis = d3.svg.axis()
                .scale(y_scale)
                .orient("left")
                .ticks(5); 
        
        //Parse date
        var parse_date = d3.time.format("%Y-%m-%dT%H:%M:%S").parse;
        var date = "2014-12-01T08:10:54";
        console.log(parse_date(date));
        



        //SVG canvas        
        var svg = d3.select("body")
                .append("svg")
                .attr("width", width+margin.left+margin.right)
                .attr("height", height+margin.top+margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
                
        //Get data
        var data_loaded = function(data) {
            var dataset = [];
            $.each(data, function(position, player) {     // position = index (interger meaning the position of the object in the array); player = object of the array
                dataset.push(player);
            });
                console.log(dataset);
                console.log(dataset[0]);
                console.log(dataset[0]["name"]);
                console.log(dataset[0]["price_list"]);
                console.log(dataset[0].price_list[1].date);                
        
        for (i = 0; i < dataset.length; i++) {
                var player = dataset[i];
                player.price_list;
                console.log(player.price_list);
        }

/*
        dataset.forEach(function(d){  }
                return {
                	d.player_name = d.player_name;   
                	for (i = 0; i < player_obj.length; i++) {  
                        var player = player_obj[i]; 
                        	price_list: data.map(function(d) {
        			return {date: d.date, price: +d[price]};
                        }
                }

        });*/
                
        x_scale.domain(d3.extent(dataset, function(d) {
                return d.date;
        }));
        y_scale.domain([0, d3.max(data, function(d) {
                return d.newyork;
        })]);

        for (i = 0; i < cities.length; i++) {
                var city = cities[i]; 
                var value_line = d3.svg.line() 
                        .interpolate("basis")  
                        .x(function(d) {   
                                return x_scale(d.date);
                        })
                        .y(function(d) {   
                                return y_scale(d[city]);
                        });
                svg.append("path")    
                        .attr("d", value_line(data))   
        };
                
        svg.append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(x_axis);
                        
        svg.append("g")
                .call(y_axis);
        }
                

        var failed_to_load = function () {
            console.log("players file failed to load!");
        }
        $.getJSON("/player_list_small.json", data_loaded)
            .fail(failed_to_load);        
        
                
    </script>
        <p>
                Changes were made yet yet yet again!
        </p>
        <p>
            Back to <a href="/index.html">Homepage</a>
        </p>
</body>
</html>
